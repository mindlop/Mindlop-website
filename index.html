<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Mindlop</title>

    <!-- Font -->
    <link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700&display=swap" rel="stylesheet">

    <style>
        body {
            margin: 0;
            font-family: Orbitron, sans-serif;
            background: black;
            color: white;
            overflow-x: hidden;
        }

        /* Moving animated background */
        body::before {
            content: "";
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: linear-gradient(120deg, #111, #000, #111);
            background-size: 300% 300%;
            animation: bgMove 8s infinite linear;
            z-index: -1;
        }

        @keyframes bgMove {
            0% { background-position: 0 0; }
            100% { background-position: 300% 300%; }
        }

        /* TOP RIGHT MENU BUTTON */
        .menu-btn {
            position: fixed;
            top: 20px;
            right: 20px;
            font-size: 35px;
            cursor: pointer;
            user-select: none;
            z-index: 5;
        }

        /* SIDEBAR */
        #sidebar {
            position: fixed;
            left: -280px;
            top: 0;
            width: 260px;
            height: 100%;
            background: #000;
            padding: 30px;
            transition: 0.4s;
            z-index: 10;
        }

        #sidebar h2 {
            margin-top: 40px;
            margin-bottom: 40px;
            font-size: 28px;
        }

        #sidebar a {
            display: block;
            color: white;
            font-size: 22px;
            margin: 25px 0;
            text-decoration: none;
            cursor: pointer;
        }

        .close-btn {
            font-size: 28px;
            cursor: pointer;
            margin-bottom: 20px;
        }

        /* MAIN CENTER */
        .center-box {
            height: 60vh;
            display: flex;
            justify-content: center;
            align-items: center;
        }

        .glow {
            font-size: 55px;
            text-align: center;
            color: #fff;
            text-shadow: 0 0 15px white;
        }

        /* Footer */
        footer {
            background: #050505;
            padding: 20px;
            text-align: center;
            margin-top: 40px;
        }

        footer h2 {
            margin-bottom: 20px;
            font-size: 24px;
        }

        .btn {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            width: 80%;
            margin: 15px auto;
            padding: 12px;
            border-radius: 30px;
            background: #111;
            color: white;
            text-decoration: none;
            font-size: 20px;
        }

        .btn img {
            width: 28px;
        }

        .support {
            margin-top: 20px;
            font-size: 18px;
            cursor: pointer;
        }

        .support img {
            width: 20px;
            vertical-align: middle;
        }

        /* Hidden Pages */
        .page {
            display: none;
            padding: 30px;
        }

        .page h1 {
            text-align: center;
            margin-bottom: 20px;
            text-shadow: 0 0 10px white;
        }

        .item-box {
            background: #111;
            padding: 15px;
            border-radius: 12px;
            margin: 15px 0;
        }

        .create-btn {
            padding: 12px 20px;
            background: #0a0a0a;
            border-radius: 20px;
            display: inline-block;
            font-size: 18px;
            margin-bottom: 10px;
            cursor: pointer;
        }

        /* NEW: image styling inside entries */
        .item-box img {
            max-width: 100%;
            height: auto;
            display: block;
            margin-top: 10px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.04);
        }

        .item-box a.market-link {
            display:inline-block;
            margin-top:8px;
            color: #ffb86b;
            word-break: break-all;
        }

        /* small note for instructions (non-intrusive) */
        .small-note {
            opacity: 0.8;
            font-size: 13px;
            margin-top: 8px;
        }
    </style>
</head>

<body id="home">

    <!-- TOP RIGHT MENU BUTTON -->
    <div class="menu-btn" onclick="openMenu()">â‹®</div>

    <!-- SIDEBAR -->
    <div id="sidebar">
        <div class="close-btn" onclick="closeMenu()">âœ•</div>
        <h2>Menu</h2>

        <a onclick="openSupport()">Support</a>
        <a onclick="showPage('models')">3D Models Download</a>
        <a onclick="showPage('articles')">Articles</a>
        <a onclick="showPage('market')">Market</a>
        <a onclick="showPage('homePage')">Home</a>
    </div>

    <!-- HOME PAGE -->
    <div id="homePage">
        <div class="center-box">
            <h1 class="glow">Mindlop</h1>
        </div>

        <footer>
            <h2>About Me</h2>

            <a class="btn" href="https://www.instagram.com/master_mind_18.0" target="_blank" rel="noopener">
                <img src="https://img.icons8.com/ios-filled/50/fa0476/instagram-new.png" alt="instagram">
                Instagram
            </a>

            <a class="btn" href="https://youtube.com/@mindlop-yt" target="_blank" rel="noopener">
                <img src="https://img.icons8.com/ios-filled/50/fa0000/youtube-play.png" alt="youtube">
                YouTube
            </a>

            <div class="support" onclick="openSupport()">
                SUPPORT <img src="https://img.icons8.com/ios-glyphs/30/ffffff/new-post.png" alt="mail">
            </div>
        </footer>
    </div>

    <!-- MODELS PAGE -->
    <div id="models" class="page">
        <h1>3D Models</h1>
        <div class="item-box">âš¡ Model 1 (Sample)</div>
        <div class="item-box">âš¡ Model 2 (Sample)</div>
        <div class="item-box">More Coming Soon...</div>
    </div>

    <!-- ARTICLES PAGE -->
    <div id="articles" class="page">
        <h1>Articles</h1>

        <div class="create-btn" onclick="createArticle()">+ Create Article</div>
        <div class="small-note">Tip: For uploading an image file type <strong>UPLOAD</strong> when asked (or paste an image URL).</div>

        <div id="articleList"></div>
    </div>

    <!-- MARKET PAGE -->
    <div id="market" class="page">
        <h1>Market</h1>

        <div class="create-btn" onclick="createMarket()">+ Add Item</div>
        <div class="small-note">Tip: You can add an image via URL or upload (type <strong>UPLOAD</strong>), and add a product link (URL).</div>

        <div id="marketList"></div>
    </div>

    <!-- Hidden file inputs for uploads -->
    <input id="articleFileInput" type="file" accept="image/*" style="display:none">
    <input id="marketFileInput" type="file" accept="image/*" style="display:none">

<script>
function openMenu() {
    document.getElementById("sidebar").style.left = "0px";
}
function closeMenu() {
    document.getElementById("sidebar").style.left = "-280px";
}

function openSupport() {
    window.location.href = "mailto:Mr.nykcontect@gmail.com";
}

function showPage(page) {
    document.getElementById("homePage").style.display = "none";
    document.querySelectorAll(".page").forEach(p => p.style.display = "none");

    if (page === "homePage") {
        document.getElementById("homePage").style.display = "block";
    } else {
        document.getElementById(page).style.display = "block";
    }
    closeMenu();
}

/* -------------------------
   Image + create handling
   ------------------------- */

/* Globals to hold pending uploads when user chooses UPLOAD */
let pendingArticleData = null;
let pendingMarketData = null;

/* Article creation: password protected, accepts image URL or UPLOAD (file) */
function createArticle() {
    let pass = prompt("Enter Password:");
    if (pass !== "1a2b3c4d") return alert("Wrong Password!");

    let title = prompt("Article Title (leave blank for none):") || "";
    let text = prompt("Write Your Article Text:") || "";

    // Ask for image URL or UPLOAD
    let imgChoice = prompt("Enter image URL, or type UPLOAD to choose a file, or leave blank for no image:");
    if (!imgChoice) {
        // no image => add immediately
        addArticleEntry(title, text, null);
        return;
    }

    if (imgChoice.trim().toUpperCase() === "UPLOAD") {
        // Start file picker flow
        pendingArticleData = { title, text };
        const input = document.getElementById('articleFileInput');
        input.value = ""; // reset
        input.onchange = handleArticleFileSelect;
        input.click();
        return;
    }

    // treat as URL
    const url = imgChoice.trim();
    addArticleEntry(title, text, { type: 'url', src: url });
}

function handleArticleFileSelect(e) {
    const file = e.target.files && e.target.files[0];
    if (!file) {
        // user cancelled file picker; fallback to no image
        if (pendingArticleData) {
            addArticleEntry(pendingArticleData.title, pendingArticleData.text, null);
            pendingArticleData = null;
        }
        return;
    }
    const reader = new FileReader();
    reader.onload = function(ev) {
        const dataUrl = ev.target.result;
        if (pendingArticleData) {
            addArticleEntry(pendingArticleData.title, pendingArticleData.text, { type: 'data', src: dataUrl });
            pendingArticleData = null;
        } else {
            // fallback (shouldn't happen)
            addArticleEntry("", "", { type: 'data', src: dataUrl });
        }
    };
    reader.readAsDataURL(file);
}

/* Market creation: password, image URL or UPLOAD, plus product URL */
function createMarket() {
    let pass = prompt("Enter Password:");
    if (pass !== "1a2b3c4d") return alert("Wrong Password!");

    let itemName = prompt("Product Name:") || "Untitled Product";
    let itemDesc = prompt("Product Description (optional):") || "";

    // get product link (URL)
    let productUrl = prompt("Enter product URL (or leave blank):") || "";

    // Ask for image URL or UPLOAD
    let imgChoice = prompt("Enter image URL, or type UPLOAD to choose a file, or leave blank for no image:");
    if (!imgChoice) {
        addMarketEntry(itemName, itemDesc, null, productUrl);
        return;
    }

    if (imgChoice.trim().toUpperCase() === "UPLOAD") {
        // Start file picker flow
        pendingMarketData = { name: itemName, desc: itemDesc, url: productUrl };
        const input = document.getElementById('marketFileInput');
        input.value = ""; // reset
        input.onchange = handleMarketFileSelect;
        input.click();
        return;
    }

    // treat as URL
    const url = imgChoice.trim();
    addMarketEntry(itemName, itemDesc, { type: 'url', src: url }, productUrl);
}

function handleMarketFileSelect(e) {
    const file = e.target.files && e.target.files[0];
    if (!file) {
        // user cancelled file picker; fallback to no image
        if (pendingMarketData) {
            addMarketEntry(pendingMarketData.name, pendingMarketData.desc, null, pendingMarketData.url);
            pendingMarketData = null;
        }
        return;
    }
    const reader = new FileReader();
    reader.onload = function(ev) {
        const dataUrl = ev.target.result;
        if (pendingMarketData) {
            addMarketEntry(pendingMarketData.name, pendingMarketData.desc, { type: 'data', src: dataUrl }, pendingMarketData.url);
            pendingMarketData = null;
        } else {
            // fallback
            addMarketEntry("Item", "", { type: 'data', src: dataUrl }, "");
        }
    };
    reader.readAsDataURL(file);
}

/* Helper to add article entry to DOM */
function addArticleEntry(title, text, imageObj) {
    const container = document.createElement('div');
    container.className = 'item-box';

    let html = "";
    if (title && title.trim() !== "") html += `<strong>${escapeHtml(title)}</strong>`;
    if (text && text.trim() !== "") html += `<p style="margin-top:8px; white-space:pre-wrap;">${escapeHtml(text)}</p>`;

    if (imageObj) {
        if (imageObj.type === 'url' || imageObj.type === 'data') {
            html += `<img src="${escapeAttr(imageObj.src)}" alt="article image">`;
        }
    }

    container.innerHTML = html;
    document.getElementById('articleList').prepend(container);
    // ensure user sees articles page
    showPage('articles');
}

/* Helper to add market entry to DOM */
function addMarketEntry(name, desc, imageObj, productUrl) {
    const container = document.createElement('div');
    container.className = 'item-box';

    let html = `<strong>ðŸ›’ ${escapeHtml(name)}</strong>`;
    if (desc && desc.trim() !== "") html += `<p style="margin-top:8px; white-space:pre-wrap;">${escapeHtml(desc)}</p>`;

    if (imageObj) {
        if (imageObj.type === 'url' || imageObj.type === 'data') {
            html += `<img src="${escapeAttr(imageObj.src)}" alt="product image">`;
        }
    }

    if (productUrl && productUrl.trim() !== "") {
        // ensure proper href (basic sanitize)
        let href = productUrl.trim();
        if (!/^https?:\/\//i.test(href)) href = 'https://' + href;
        html += `<a class="market-link" href="${escapeAttr(href)}" target="_blank" rel="noopener noreferrer">${escapeHtml(href)}</a>`;
    }

    container.innerHTML = html;
    document.getElementById('marketList').prepend(container);
    // ensure user sees market page
    showPage('market');
}

/* Simple helpers to avoid raw HTML injection */
function escapeHtml(unsafe) {
    return String(unsafe)
         .replaceAll("&","&amp;")
         .replaceAll("<","&lt;")
         .replaceAll(">","&gt;")
         .replaceAll('"',"&quot;")
         .replaceAll("'","&#039;");
}
function escapeAttr(unsafe) {
    return String(unsafe).replaceAll('"','&quot;').replaceAll("'", "&#039;");
}

/* Accessibility: if user presses Escape close sidebar */
document.addEventListener('keydown', (e) => {
    if (e.key === 'Escape') closeMenu();
});

/* keep home visible initially */
showPage('homePage');
</script>

</body>
</html>